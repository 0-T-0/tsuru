.. warning::

    Version under development

=======================
tsr 0.7.0 release notes
=======================

Welcome to tsr 0.7.0!

These release notes cover the `new features`_, `bug fixes`_, `backward
incompatible changes`_ and `general improvements`_ you'll want to be aware of
when upgrading from tsr 0.6.0 or older versions.

.. _`new features`: `What's new in tsr 0.7.0`_
.. _`general improvements`: `Other improvements in tsr 0.7.0`_

What's new in tsr 0.7.0
=======================

- quota management via API is back: now tsuru administrators are able to view
  and change the quota of a user of an application. It can be done from the
  remote API or using tsuru-admin (issue `#869
  <https://github.com/tsuru/tsuru/issues/869>`_)
- deploy via upload: now it's possible to upload a tar archive to the API. In
  this case, users are able to just drop the file in the tsuru server, without
  using git. This feature enables the deployment of binaries, WAR files, and
  other things that may need local processing (issue `#874
  <https://github.com/tsuru/tsuru/issues/874>`_). The tsuru client also
  includes a ``tsuru deploy`` command
- removing platforms via API: now tsuru administrators are able to remove
  platforms from tsuru. It can be done from the remote API or using tsuru-admin
  (issue `#779 <https://github.com/tsuru/tsuru/issues/779>`_)
- new apps now get a new environment variable: ``TSURU_APPDIR``. This
  environment variable represents the path where the application was deployed,
  the root directory of the application (issue `#783
  <https://github.com/tsuru/tsuru/issues/783>`_)
- now tsuru server will reload configuration on SIGHUP. Users running the API
  under upstart or other services like that are now able to call the ``reload``
  command and get the expected behaviour (issue `#898
  <https://github.com/tsuru/tsuru/issues/898>`_)
- multiple cnames: now it's possible to app have multiple cnames. The ``tsuru set-
  cname`` and ``tsuru unset-cname`` commands changed to ``tsuru add-cname`` and
  ``tsuru remove-cname`` respectively (issue `#677
  <https://github.com/tsuru/tsuru/issues/677>`_).
- tsuru is now able to heal failing nodes and containers automatically, this is
  disabled by default. Instructions can be found in the :ref:`config reference
  <config_healing>`

Bug fixes
=========

- API: fix the endpoint for creating new services so it returns 409 Conflict
  instead of 500 when there's already a service registered with the provided
  name

- PlatformAdd: returns better error when an platform is added but theres no node to build the platform image (issue `#906 <https://github.com/tsuru/tsuru/issues/906>`_).

Other improvements in tsr 0.7.0
===============================

- API: improve the App swap endpoint, so it will refuse to swap incompatible
  apps. Two apps are incompatible if they don't use the same platform or don't
  have the same amount of units. Users can force the swap of incompatible apps
  by providing the force parameter (issue `#582
  <https://github.com/tsuru/tsuru/issues/582>`_)
- API: admin users now see all service instances in the service instances list
  endpoint (issue `#614 <https://github.com/tsuru/tsuru/issues/614>`_)
- API: Handler that returns information about the deploy has implemented. Its
  included the diff attribute that returns the difference between the last
  commit and the preceding it.

Backward incompatible changes
=============================

- ``tsr ssh-agent`` has been totally removed, it's no longe possible to use it
  with tsuru server
- tsuru no longer accepts teams with space in the name (issue `#674
  <https://github.com/tsuru/tsuru/issues/674>`_)
- tsuru no longer supports ``docker:cluster:storage`` set to ``redis``, the only
  storage available is now ``mongodb``. See :ref:`config reference
  <config_cluster_storage>` for more details. Also, there's a `python script
  <https://gist.github.com/cezarsa/d2c8b8db611af9a2d67d>`_ that can be used to
  migrate from ``redis`` to ``mongodb``.
